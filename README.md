# Поиск оптимальной траектории движения робота

Программа для поиска оптимального пути движения мобильного робота с использованием генетического алгоритма. Робот должен добраться из точки (10, 10) в точку (0, 0), обходя два круглых препятствия.

## Описание

Программа использует генетический алгоритм для оптимизации управления роботом. В процессе работы:
- Генерируется популяция возможных траекторий
- Каждая траектория оценивается по критерию, учитывающему время движения, расстояние до цели, штрафы за столкновения и энергозатраты
- Лучшие решения отбираются и скрещиваются для создания новых поколений
- Результат сохраняется в виде графика траектории (`trajectory.png`)

## Требования

- Операционная система: Windows, Linux или macOS
- Интернет-соединение (для скачивания Go и зависимостей)

## Установка Go

Если у вас не установлен Go, выполните следующие шаги:

### Windows

1. Скачайте установщик Go с официального сайта: https://go.dev/dl/
2. Выберите версию для Windows (например, `go1.21.x.windows-amd64.msi`)
3. Запустите установщик и следуйте инструкциям
4. После установки откройте новое окно PowerShell или командной строки
5. Проверьте установку командой:
   ```powershell
   go version
   ```

### Linux

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install golang-go

# Проверьте установку
go version

# Или скачайте с https://go.dev/dl/ и установите вручную
```

### macOS

```bash
# Используя Homebrew
brew install go

# Проверьте установку
go version

# Или скачайте установщик с https://go.dev/dl/
```

## Установка и запуск программы

1. **Клонируйте репозиторий или скачайте файлы проекта**

2. **Откройте терминал в папке проекта**

   ```bash
   cd /path/to/lab2_opt_tr_COPY
   ```

3. **Инициализируйте модуль Go и установите зависимости:**

   ```bash
   go mod init lab2_opt_tr
   go mod tidy
   ```

   Это создаст файл `go.mod` и скачает необходимые библиотеки.

4. **Запустите программу:**

   ```bash
   go run main.go
   ```

   Или скомпилируйте и запустите:

   ```bash
   go build -o trajectory main.go
   ./trajectory
   ```

## Результаты работы

После выполнения программы будут созданы:

- **`trajectory.png`** - график оптимальной траектории движения робота
- В консоли будет выведена информация:
  - Значение функционала (Best J)
  - Достигнута ли цель (Reached goal)
  - Финальное расстояние до цели
  - Время движения
  - Узлы управления u1 и u2
  - Примеры значений управления в разные моменты времени

## Основные фишки программы

### Функционал

Программа реализует комплексную систему оптимизации траектории движения мобильного робота:

1. **Генетический алгоритм** с полным набором операторов:
   - Турнирный отбор (`TournamentSize = 5`)
   - Элитизм - сохранение лучших решений без изменений
   - Арифметический кроссовер с вероятностью 90%
   - Гауссова мутация с настраиваемой амплитудой

2. **Модель динамики робота**:
   - Дифференциальный привод (управление через скорости колес u1 и u2)
   - Состояние: координаты (X1, X2) и угол ориентации (X3)
   - Преобразование управлений в линейную и угловую скорости

3. **Численное интегрирование**:
   - Метод Рунге-Кутты 4-го порядка (RK4) для точного моделирования динамики
   - Шаг интегрирования `DT = 0.02` секунды

4. **Кусочно-линейное управление**:
   - Управление разбито на `NSegments = 20` сегментов
   - Линейная интерполяция между узлами управления
   - Ограничения на управления: `Umin = -10.0`, `Umax = 10.0`

5. **Многоцелевая оптимизация**:
   - Минимизация времени движения до цели
   - Минимизация энергозатрат (интеграл от квадратов управлений)
   - Гладкость траектории (штраф за резкие изменения управлений)
   - Точность достижения цели (расстояние до точки (0, 0))
   - Избегание препятствий через систему штрафов

6. **Система препятствий**:
   - Два круглых препятствия: центры (2.5, 2.5) и (7.5, 7.5), радиус 2.5
   - Зона безопасности (`SafeMargin = 0.010`) вокруг препятствий
   - Градиентные штрафы за приближение к препятствиям
   - Огромный штраф (`CollisionPen = 1000000.0`) за столкновение

7. **Визуализация результатов**:
   - Автоматическое построение графика траектории
   - Отображение препятствий, начальной точки и цели
   - Легенда и подписи осей

### Параметры генетического алгоритма

Параметры ГА можно изменить в начале файла `main.go`:

- `PopSize = 300` - размер популяции
- `Generations = 1000` - число поколений
- `EliteCount = 10` - количество лучших особей, переносимых без изменений
- `CrossoverRate = 0.9` - вероятность кроссовера
- `MutationRate = 0.2` - вероятность мутации гена
- `MutationSigma = 2.0` - амплитуда мутации
- `TournamentSize = 5` - размер турнира для отбора

### Параметры задачи управления

- `TMax = 15.0` - максимальное время моделирования (секунды)
- `NSegments = 20` - количество сегментов управления
- `GoalEps = 0.20` - допустимое расстояние до цели для успешного завершения
- `Umin = -10.0`, `Umax = 10.0` - ограничения на управления
- `DT = 0.02` - шаг интегрирования (секунды)

### Параметры штрафов и весов

- `AlphaPen = 8000.0` - коэффициент штрафа в зоне безопасности
- `CollisionPen = 1000000.0` - штраф за столкновение с препятствием
- `SafeMargin = 0.010` - ширина зоны безопасности вокруг препятствий
- `EnergyWeight = 0.0010` - вес энергозатрат в функционале
- `SmoothWeight = 0.10` - вес гладкости траектории
- `GoalWeight = 80.0` - вес расстояния до цели в финальный момент

### Начальные условия

- Начальная позиция: `X1 = 10.0`, `X2 = 10.0`
- Начальный угол: `X3 = 0.0`
- Целевая точка: `(0, 0)`

## Возможные проблемы

### Ошибка "go: command not found"
- Убедитесь, что Go установлен и добавлен в PATH
- Перезапустите терминал после установки Go

### Ошибка при скачивании зависимостей
- Проверьте интернет-соединение
- Убедитесь, что у вас есть доступ к https://proxy.golang.org

### Программа работает долго
- Это нормально, генетический алгоритм требует времени на вычисления
- Можно уменьшить `PopSize` или `Generations` для более быстрого результата (но качество может снизиться)

## Лицензия
Этот проект создан в учебных целях.

